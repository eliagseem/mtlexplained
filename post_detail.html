<!doctype html>
<html>
<head>
<link href="https://fonts.googleapis.com/css?family=Oswald" rel="stylesheet">
<script src='https://cdn.firebase.com/js/client/2.2.1/firebase.js'></script>
<script src='https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js'></script>

<script src="js/jquery.min.js"></script>
<script src='https://cdnjs.cloudflare.com/ajax/libs/angular.js/1.5.2/angular.min.js'></script>
<script src='https://cdnjs.cloudflare.com/ajax/libs/angular-filter/0.5.8/angular-filter.js'></script>
<script src='https://cdn.firebase.com/js/client/2.2.4/firebase.js'></script>
<script src="js/angularfire.min.js"></script>
<script  src="js/index.js"></script>

<link rel='stylesheet prefetch' href='https://fonts.googleapis.com/icon?family=Material+Icons'>
<link rel='stylesheet prefetch' href='https://fezvrasta.github.io/bootstrap-material-design/dist/css/bootstrap-material-design.css'>
<meta charset="utf-8">
<title>Post</title>
<link href="style.css" rel="stylesheet" type="text/css">
</head>

<body>
	<div class="page">
		<div class="map"><a href="map.html"><img src="images/backw.png" alt="back" width="auto" height="50"></a></div>
		<div class="settings"><img src="images/settingsw.png" alt="settings" width="auto" height="60"></div>

		<script>
			commentsList = "";
			var app = angular.module('plunker', []);
			
			app.controller('MainCtrl', function($scope) {

			post = "";

            var url_string = window.location.href;
            var url = new URL(url_string);
            var c = url.searchParams.get("postId");
            			
			var ref2 =  new Firebase("https://mtlexplained.firebaseio.com/").child('/posts').child(c);
			ref2.once('value', function(snapshot) {

				if(snapshot.val() === null ) {
					/* does not exist */
				} else {
					post = snapshot.val();
					//snapshot.ref().update({"postID": postID});
					/* snapshot.ref().child("comments").push({
						"username" : "theartfreak",
							"role" : "VERIFIED TOUR GUIDE",
							"rating" : 122,
							"cDescription": "Woah that's it lol... thats arts"
					}
					); */
					$scope.commentsList = snapshot.val().comments;
					$scope.$apply();
					document.getElementById("postId").src=post.base64;
					document.getElementById("locationName").innerHTML=post.locName;
					document.getElementById("postComment").innerHTML=post.description;
					document.getElementById("postRole").innerHTML=post.role;
					document.getElementById("postUser").innerHTML=post.username;
					}
				});


			});

		</script>

	<div class="postImg"><img id="postId" width="100%" height="100%"></div>

	<div class="commentBar">
		<div class="commentPP"><img src="images/profile_pic.png" alt="Profile Photo" width="auto" height="auto"></div>
		<div class="commentPad"></div>
		<div id="postComment" class="commentDesc"></div>
		<div id="postUser" class="commentUser"></div>
		<div id="postRole" class="commentInfo"></div>
		<div class="postloc"><img src="images/postloc.png" alt="map" width="auto" height="auto">
			<div id="locationName" class="commentLocation"></div>
		</div>
	</div>

	<div ng-app='plunker'>
	<div ng-controller="MainCtrl">	
		<div ng-repeat="comment in commentsList">
			<div class="commenterBox">
					<div class="ratingBox">
						<div class="rating" id="ratingnumber">{{comment.rating}}</div>
							<div class="triangles">
								<div class="triangle-up" onclick="counter()"></div>
								<div class="triangle-down" onclick="uncounter()"></div>
							</div>
						</div>
			
					<div class="commentDesc">{{comment.cDescription}}</div>
					<div class="commentUser">{{comment.username}}</div>
					<div class="commentInfoV"> | {{comment.role}}</div>
					<div class="commentDesc"><div class="lineBreak"></div></div>
			</div>						
		</div>
		
	</div>

	<div class="buffer"></div>

	<div class="commentButton">
		<a href="post.html" style="float:right;text-align:left;">POST</a>			
		<div class="inputCommentBox">			
			<textarea rows="4" cols="50" name="comment" form="usrform" maxlength="200" placeholder="answer the question"
			onfocus="this.placeholder = ''" onblur="this.placeholder = 'enter your text'" ></textarea>
		</div>
	</div>
</div>


<!--SUBMIT
	<div>
		<textarea name="comments" id="comments" style="font-family: Cambria, 'Hoefler Text', 'Liberation Serif', Times, 'Times New Roman', 'serif';font-size: 1.2 em;">answer the question</textarea>
	</div>
	<input type="submit" value="Submit">
-->

<script>
var add = (function () {
    var counter = 12;
    return function () {return counter += 1;}
})();

var subtract = (function () {
    var counter = 12;
    return function () {return counter -= 1;}
})();

function counter(){
    document.getElementById("ratingnumber").innerHTML = add();
}

function uncounter(){
    document.getElementById("ratingnumber").innerHTML = subtract();
}
</script>

</div>

</body>
</html>
